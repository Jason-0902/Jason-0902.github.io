<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Relational Algebra CLI (Web)</title>
  <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
  <script defer src="js/app.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f0f0f0; }
    textarea { width: 100%; height: 100px; font-family: monospace; }
    #output { white-space: pre-wrap; background: #fff; padding: 10px; border: 1px solid #ccc; margin-top: 10px; }
    button { padding: 10px 20px; margin-top: 10px; }
    h2 { color: #007acc; margin-top: 2em; }
    code { background: #eee; padding: 2px 4px; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>Relational Algebra CLI Simulator (Pyodide)</h1>

  <h2>📘 Supported Commands</h2>
  <ul>
    <li>
      <strong>CREATE TABLE</strong><br>
      <code>CREATE TABLE table_name (column1, column2)</code><br>
      👉 Create a new table with specified columns.
    </li>
    <li>
      <strong>INSERT INTO</strong><br>
      <code>INSERT INTO table_name VALUES (value1, value2)</code><br>
      👉 Insert one row of values into the specified table.
    </li>
    <li>
      <strong>SELECT *</strong><br>
      <code>SELECT * FROM table_name</code><br>
      👉 Display all rows from the table.
    </li>
  </ul>
  <p><strong>Note:</strong> Commands are case-insensitive. Use <code>Enter</code> to run; <code>Shift+Enter</code> for new line.</p>

  <h2>🧪 Try it below</h2>
  <textarea id="input" placeholder="e.g. CREATE TABLE students (id, name)"></textarea>
  <br />
  <button onclick="runPython()">Execute</button>
  <div id="output">Output will appear here...</div>

  <!-- Python code safely embedded -->
  <script id="pycode" type="text/plain">
import pandas as pd

tables = {}

def run_command(cmd: str) -> str:
    global tables
    try:
        cmd = cmd.strip()
        if cmd.upper().startswith("CREATE TABLE"):
            name, cols = cmd[13:].split("(", 1)
            name = name.strip()
            cols = [c.strip() for c in cols.strip(")").split(",")]
            tables[name] = pd.DataFrame(columns=cols)
            return f"✅ Created table '{name}' with columns: {cols}"
        elif cmd.upper().startswith("INSERT INTO"):
            name, rest = cmd[12:].split("VALUES", 1)
            name = name.strip()
            values = rest.strip().strip("()").split(",")
            values = [v.strip().strip("'\\\"") for v in values]
            if name not in tables:
                return f"❌ Table '{name}' does not exist"
            tables[name].loc[len(tables[name])] = values
            return f"✅ Inserted into '{name}': {values}"
        elif cmd.upper().startswith("SELECT * FROM"):
            name = cmd[14:].strip()
            if name not in tables:
                return f"❌ Table '{name}' does not exist"
            return str(tables[name])
        else:
            return "❌ Unsupported command"
    except Exception as e:
        return f"❌ Error: {e}"
  </script>
</body>
</html>
